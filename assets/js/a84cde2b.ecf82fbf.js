"use strict";(globalThis.webpackChunkmy_docs=globalThis.webpackChunkmy_docs||[]).push([[2070],{8453(e,n,s){s.d(n,{R:()=>o,x:()=>a});var t=s(6540);const r={},l=t.createContext(r);function o(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(l.Provider,{value:n},e.children)}},8545(e,n,s){s.r(n),s.d(n,{assets:()=>i,contentTitle:()=>a,default:()=>u,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"osep/Defense Evasion/Enumerate Defenses","title":"Enumerate Defenses","description":"Enumerate Defenses","source":"@site/docs/osep/Defense Evasion/Enumerate Defenses.md","sourceDirName":"osep/Defense Evasion","slug":"/osep/Defense Evasion/Enumerate Defenses","permalink":"/OSEP-Playbook/osep/Defense Evasion/Enumerate Defenses","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Enable RDP Pass-The-Hash","permalink":"/OSEP-Playbook/osep/Defense Evasion/Enable RDP Pass-The-Hash"},"next":{"title":"Shutdown Firewall","permalink":"/OSEP-Playbook/osep/Defense Evasion/Shutdown Firewall"}}');var r=s(4848),l=s(8453);const o={},a=void 0,i={},c=[{value:"<strong>Enumerate Defenses</strong>",id:"enumerate-defenses",level:3}];function d(e){const n={code:"code",h3:"h3",li:"li",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h3,{id:"enumerate-defenses",children:(0,r.jsx)(n.strong,{children:"Enumerate Defenses"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Get AppLocker State"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections\n\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Get AMSI State"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'# CMD\nreg query "HKLM\\Software\\Microsoft\\AMSI"\n# 0 = disabled\n# 1 (or exist but is missing) = enabled\n\n# PowerShell\n\'amsiutils\'\n\n# Alternative\nGet-Process -Name powershell | ForEach-Object { $_.Modules | Where-Object { $_.ModuleName -eq "amsi.dll" } }\n# If amsi.dll is loaded then AMSI is active\n# If not AMSI is disabled or bypassed\n\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Check if Defender is Working"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"Get-MpComputerStatus | Select-Object AMRunningMode, AntivirusEnabled\n\nGet-MpComputerStatus\n\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Get CLM State"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:"$ExecutionContext.SessionState.LanguageMode\n\n# FullLanguaje: allows all cmdlets and entire .NET Framework\n# RestrictedLanguage allows default cmdlets but heavily restricts everything else\n# NoLanguage: disables all script text\n\n"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Get PPL (Protected Processes Light) State"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-powershell",children:'Get-ItemProperty -Path HKLM:\\SYSTEM\\CurrentControlSet\\Control\\Lsa -Name "RunAsPPL"\n\n'})})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);